<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MemoryKeeper - AI-powered story collection for preserving life memories">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <title>MemoryKeeper - AI Chat</title>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://vibe-agents.onrender.com/">
    <meta property="og:title" content="MemoryKeeper - AI-powered story collection">
    <meta property="og:description" content="Share your life stories with AI - Collaborator and Memory Keeper agents help capture and organize your memories">
    <meta property="og:site_name" content="MemoryKeeper">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://vibe-agents.onrender.com/">
    <meta property="twitter:title" content="MemoryKeeper - AI-powered story collection">
    <meta property="twitter:description" content="Share your life stories with AI - Collaborator and Memory Keeper agents help capture and organize your memories">
    
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/auth.css">
    
    <!-- Import map for Firebase ESM modules -->
    <script type="importmap" src="/importmap.json"></script>

    <!-- Crypto utilities for secure data storage -->
    <!-- Expose environment before config -->
    <script src="/env.js"></script>
    <script src="js/config.js"></script>
    <script src="js/crypto-utils.js"></script>
</head>
<body>
    <!-- App Header -->
    <header id="app-header" class="app-header">
        <div class="app-header-container">
            <div class="app-header-content">
                <!-- Logo -->
                <div class="app-logo">
                    <h1>MemoryKeeper</h1>
                </div>

                <!-- Controls -->
                <div class="app-controls">
                    <!-- Create Artifact Button -->
                    <button id="create-artifact-btn" class="control-btn artifact-btn" aria-label="Create Artifact">
                        <span class="btn-icon">âœ¨</span>
                        <span class="btn-text">Create Artifact</span>
                        <span class="btn-text-mobile">Create</span>
                    </button>

                    <!-- Reset Chat -->
                    <button id="reset-chat-btn" class="control-btn reset-btn" aria-label="Reset Chat">
                        <span class="btn-icon">â†»</span>
                        <span class="btn-text">Reset Chat</span>
                        <span class="btn-text-mobile">Reset</span>
                    </button>

                    <!-- Export Chat -->
                    <button id="export-chat-btn" class="control-btn export-btn" aria-label="Export Chat">
                        <span class="btn-icon">â†“</span>
                        <span class="btn-text">Export</span>
                    </button>

                    <!-- AI Model Dropdown -->
                    <div class="dropdown-container">
                        <button id="model-dropdown-btn" class="control-btn model-btn">
                            <span class="btn-icon">âš™</span>
                            <span id="selected-model" class="btn-text">Claude Sonnet 3.5</span>
                            <span class="btn-text-mobile">Model</span>
                            <span class="dropdown-arrow">â–¼</span>
                        </button>

                        <div id="model-dropdown" class="dropdown-menu hidden">
                            <button class="model-option active" data-model="claude-3-5-sonnet-latest">
                                Claude 3.5 Sonnet
                            </button>
                            <button class="model-option" data-model="claude-3-5-haiku-latest">
                                Claude 3.5 Haiku
                            </button>
                        </div>
                    </div>

                    <!-- Logout (replaces Profile dropdown) -->
                    <button id="logout-btn" class="control-btn logout-btn" aria-label="Logout">
                        <span class="btn-icon">ðŸ‘¤</span>
                        <span class="btn-text">Logout</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="chat-container">
        <div class="main-content" id="chat-container">
            <div class="chat-section">
                <div class="chat-collab-header" aria-label="Collaborator chat header">
                    <h3>Collaborator</h3>
                    <div class="chat-status" id="chat-status">Ready</div>
                </div>
                <div class="chat-messages" id="chat-messages">
                    <!-- Messages will be added here -->
                </div>
                
                <div class="chat-input-area">
                    <div class="typing-indicator hidden" id="typing-indicator">
                        <span class="typing-message">Processing your story...</span>
                        <div class="typing-progress">
                            <div class="typing-progress-bar" id="typing-progress-bar"></div>
                        </div>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                    
                    <div class="input-container">
                        <input type="text" class="chat-input" placeholder="Share your story..." id="chat-input">
                        <button class="send-btn" id="send-btn">Send</button>
                    </div>
                </div>
            </div>
            
            <div class="memory-panel" id="memory-panel">
                <div class="memory-header">
                    <h3>Extracted Memories</h3>
                    <div class="memory-status" id="memory-status">Ready</div>
                </div>
                
                <div class="memory-content">
                    <div class="memory-section">
                        <h4>People</h4>
                        <div class="memory-items" id="memory-people">
                            <div class="memory-placeholder">No people mentioned yet</div>
                        </div>
                    </div>
                    <div class="memory-section">
                        <h4>Dates & Times</h4>
                        <div class="memory-items" id="memory-dates">
                            <div class="memory-placeholder">No dates mentioned yet</div>
                        </div>
                    </div>
                    <div class="memory-section">
                        <h4>Places</h4>
                        <div class="memory-items" id="memory-places">
                            <div class="memory-placeholder">No places mentioned yet</div>
                        </div>
                    </div>
                    <div class="memory-section">
                        <h4>Relationships</h4>
                        <div class="memory-items" id="memory-relationships">
                            <div class="memory-placeholder">No relationships mentioned yet</div>
                        </div>
                    </div>
                    <div class="memory-section">
                        <h4>Events</h4>
                        <div class="memory-items" id="memory-events">
                            <div class="memory-placeholder">No events mentioned yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="tap-hint hidden" id="tap-hint">Click anywhere to continue the conversation</div>

    <!-- Logging Panel -->
    <div class="logging-panel hidden" id="logging-panel">
        <div class="logging-header">
            <h3>Agent Data Flow Log</h3>
            <div class="logging-controls">
                <button id="clear-log-btn" class="log-btn">Clear Log</button>
                <button id="export-log-btn" class="log-btn">Export Log</button>
            </div>
        </div>
        <div class="logging-content">
            <div class="log-column">
                <h4>Input & Requests</h4>
                <div class="log-entries" id="log-inputs"></div>
            </div>
            <div class="log-column">
                <h4>Responses & Processing</h4>
                <div class="log-entries" id="log-outputs"></div>
            </div>
        </div>
    </div>



    <!-- Firebase and App Scripts -->
    <script type="module" src="js/firebase-config.js"></script>
    <script src="js/app-header.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
